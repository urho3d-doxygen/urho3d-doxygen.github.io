<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Urho3D: Porting notes</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Urho3D
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Porting notes </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >From 1.4 to 1.5:</p>
<ul>
<li>Urho preprocessor macros are now prefixed URHO3D_ , for example URHO3D_LOGINFO, URHO3D_HANDLER, URHO3D_DEFINE_APPLICATION_MAIN.</li>
<li>Build system - for projects using GCC/Clang compiler toolchain, set the URHO3D_DEPLOYMENT_TARGET build option according to the target audience of the downstream projects. The default value for this build option is 'native' which is great for Urho3D newbie but may potentially cause issue when this build option is not observed and set accordingly for production. The same is true for CMAKE_OSX_DEPLOYMENT_TARGET and IPHONEOS_DEPLOYMENT_TARGET build options when targeting macOS and iOS platforms, however, the latter two build options are not new.</li>
</ul>
<p >From 1.5 to 1.6:</p>
<ul>
<li>The keycode constant KEY_ESC was renamed to KEY_ESCAPE to match SDL's convention.</li>
<li>Alphabetic keycode constants are now lowercase to match SDL's convention. It's preferable to always use these constants instead of character literals. For compatibility, passing uppercase letters to e.g. <a class="el" href="class_urho3_d_1_1_input.html#a1bb78ebd178b5f9ddb6632c0fa4fe255" title="Check if a key is held down.">Input::GetKeyDown()</a> still works, but comparing to uppercase literals in key event handling will cause a mismatch and non-functioning controls.</li>
<li>Bitmask based vertex declarations are emulated by converting to corresponding <a class="el" href="struct_urho3_d_1_1_vertex_element.html" title="Vertex element description for arbitrary vertex declarations.">VertexElement</a> declarations. This should not cause issues, but it's recommended to migrate to VertexElement based declarations for better flexibility and control, and to go through any application code that uses the <a class="el" href="class_urho3_d_1_1_vertex_buffer.html" title="Hardware vertex buffer.">VertexBuffer</a> class to verify correctness.</li>
<li>As part of the freeform vertex declaration change, GLSL vertex attributes' semantic indices are now zero-based. The first texcoord would be called iTexCoord or iTexCoord0, and the second iTexCoord1. This matches HLSL semantics that are also zero-based. Instance transform is passed in texcoord semantic indices 4-6 on both GLSL &amp; HLSL.</li>
<li>cCameraRot matrix uniform has been removed. Camera rotation can instead be extracted from the cViewInv uniform.</li>
<li>Deferred lighting calculations are now performed in true world space, instead of camera-centered world space.</li>
<li><a class="el" href="class_urho3_d_1_1_sound_source.html" title="Sound source component with stereo position. A sound source needs to be created to a node to be consi...">SoundSource</a> autoremove functionality is deprecated and will be removed in the future. The SoundFinished event can be used instead to react to playback finishing and to perform the necessary action, for example to remove the sound component or its owner node.</li>
<li><a class="el" href="class_urho3_d_1_1_string.html" title="String class.">String</a> add operator with char parameter has been removed due to danger of truncating e.g. an int. Replace with adding a string literal (if applicable) or using add-assign or Append() function.</li>
<li>Build system - Windows users need to upgrade CMake version to 3.2.3 or higher. CMake version 3.2.3 will be the minimum version required for building Urho3D library on any host systems in the future releases. Mac users need to upgrade CMake version to 3.4.1 or higher when using URHO3D_LUAJIT build option.</li>
<li>Build system - the inclusion of Urho3D-CMake-common.cmake module into downstream project's CMakeLists.txt would implicitly instruct CMake to find all the required software packages, including Urho3D library. There is no need now for downstream's CMakeLists.txt to call "find_package (Urho3D)" explicitly, to avoid the Urho3D library from being searched twice. The enhanced FindUrho3D.cmake module now auto-discovers the build options used when building Urho3D library and reapply them to downstream projects. There is no need for users to remember and to supply the same set of build options when performing the initial configuration/generation of the downstream project's build tree.</li>
<li>Build system - the Urho3DAll.h header file is now auto-generated for downstream project that needs it. It is not a good practice though to use this "convenience header" as it would slow down the build process unnecessarily.</li>
</ul>
<p >From 1.6 to 1.7:</p>
<ul>
<li><a class="el" href="class_urho3_d_1_1_sound_source.html" title="Sound source component with stereo position. A sound source needs to be created to a node to be consi...">SoundSource</a> autoremove boolean was replaced with AutoRemoveMode enum, which allows removing either the component or owner node. Also used by <a class="el" href="class_urho3_d_1_1_particle_emitter.html" title="Particle emitter component.">ParticleEmitter</a>.</li>
<li>Getting camera projection matrix has changed. Use GetProjection() to get the API-independent matrix, and GetGPUProjection() to get the matrix converted to be usable as a shader parameter. On D3D these are the same.</li>
<li>Alpha masking hint has been removed from <a class="el" href="class_urho3_d_1_1_technique.html" title="Material technique. Consists of several passes.">Technique</a> &amp; <a class="el" href="class_urho3_d_1_1_pass.html" title="Material rendering pass, which defines shaders and render state.">Pass</a>, due to materials also now being able to define additional shader compilation defines. You can use <a class="el" href="class_urho3_d_1_1_material.html#abca785eba922eb89dc49d0815b55d47a" title="Set 8-bit render order within pass. Default 0. Lower values will render earlier and higher values lat...">Material::SetRenderOrder()</a> instead to ensure that partially opaque geometry will be drawn after fully opaque for GPU depth buffer optimization. Due to this change you must also manually define that a material should not take part in occlusion rendering, see <a class="el" href="class_urho3_d_1_1_material.html#a3204225b474a7e910dde75a8a7119269" title="Set whether to use in occlusion rendering. Default true.">Material::SetOcclusion()</a>.</li>
<li>Techniques that existed just for shader defines like ALPHAMASK and PACKEDNORMAL have been removed. Replace by using techniques without those defines (e.g. DiffNormal instead of DiffNormalPacked), and adding the necessary defines to your materials instead.</li>
<li>The <a class="el" href="class_urho3_d_1_1_light.html" title="Light component.">Light</a> class has gained a max extrusion distance parameter for directional light shadows. In case you use a large far clip distance, you can experience different shadow depth resolution and effect of bias parameters, as the far clip distance no longer alone determines the extrusion. Adjust with <a class="el" href="class_urho3_d_1_1_light.html#a3923fe947b9640e9c2465039ea8bb9df" title="Set maximum shadow extrusion for directional lights. The actual extrusion will be the smaller of this...">Light::SetShadowMaxExtrusion()</a> as necessary.</li>
<li>Direct3D binary shaders are now cached by default to the user preferences directory "urho3d/shadercache" to avoid writing into the application installation directory, to which the user may not have rights. If you ship a prewarmed (read-only) cache with your application you can set the directory yourself from the engine startup parameter "ShaderCacheDir" or call <a class="el" href="class_urho3_d_1_1_graphics.html#af4eb08ce8ac2837061483158aa836874" title="Set shader cache directory, Direct3D only. This can either be an absolute path or a path within the r...">Graphics::SetShaderCacheDir()</a> on initialization. Use the directory "Shaders/HLSL/Cache" to get the old behavior.</li>
<li>Signatures of <a class="el" href="class_urho3_d_1_1_u_i_element.html" title="Base class for UI elements.">UIElement</a> virtual functions OnResize() and OnPositionSet() have changed.</li>
<li>The <a class="el" href="class_urho3_d_1_1_font.html" title="Font resource.">Font</a> class and related classes take font size as a float instead of int to allow fractional point sizes. Glyphs themselves may also have fractional positions, so floats are now used internally in text rendering.</li>
<li><a class="el" href="class_urho3_d_1_1_u_i_element.html#ab9428239491cc05e1782eafa60eb9e5b" title="Create a child by loading from XML data with style. Returns the child element if successful,...">UIElement::LoadChildXML()</a> now returns the created element on success, instead of a boolean.</li>
<li>Rendertargets have gained the ability to have automatically regenerated mipmaps. Screen buffers received from the <a class="el" href="class_urho3_d_1_1_renderer.html" title="High-level rendering subsystem. Manages drawing of 3D views.">Renderer</a> subsystem have mipmaps off, but for manually created rendertargets the default is mipmaps on, like for ordinary textures. Use SetNumLevels(1) to disable.</li>
<li>The shader function GetWorldTangent() now returns a 4-component vector.</li>
<li><a class="el" href="class_urho3_d_1_1_animated_model.html" title="Animated model component.">AnimatedModel</a> allows unclamped morph weights, also negative.</li>
<li><a class="el" href="class_urho3_d_1_1_static_model.html#a9cf254e2f4535519c8ee06d42d736402" title="Set model.">StaticModel::SetModel()</a> will no longer warn and redirect to <a class="el" href="class_urho3_d_1_1_animated_model.html#a67a9794df35c334b050f689bb706847a" title="Set model.">AnimatedModel::SetModel()</a> if the wrong function is called from C++ code. The AngelScript API will instead redirect properly without producing a warning.</li>
<li><a class="el" href="class_urho3_d_1_1_graphics.html#aac131622deee0f32dffe86943d704f95" title="Set default window modes. Deprecated. Return true if successful.">Graphics::SetMode()</a>, <a class="el" href="class_urho3_d_1_1_graphics.html#aba59cc45386b346ff5b7078516dbb95b" title="Return the desktop resolution.">Graphics::GetDesktopResolution()</a> and <a class="el" href="class_urho3_d_1_1_graphics.html#a86ed5b63d5e24b7ce5795b2b831530a9" title="Return supported fullscreen resolutions (third component is refreshRate). Will be empty if listing th...">Graphics::GetResolutions()</a> have gained an extra parameter to specify the monitor to use. Use <a class="el" href="class_urho3_d_1_1_graphics.html#a752c8c2c1b3d1d97ab07f9e90f3821a8" title="Return the number of currently connected monitors.">Graphics::GetMonitorCount()</a> to get the number of attached monitors. Monitor number 0 means the default primary monitor.</li>
<li>P_CONTACT parameter was removed from 2D physics collision events. Use P_CONTACTS buffer instead.</li>
<li>GetPlatform() function returns "macOS" instead of "Mac OS X".</li>
<li>Build system - the "Urho3D-CMake-common.cmake" file is now renamed to "UrhoCommon.cmake".</li>
<li>Build system - downstream project is now responsible to add the HTML shell-file by calling the add_html_shell() macro or by passing "HTML_SHELL" option when calling the define_resource_dirs() in order to generate the HTML output when targeting Web platform, i.e. the build system defaults to JS output now, except when URHO3D_TESTING build option is set. When URHO3D_TESTING is set then it is assumed the output should be test runnable by using emrun, therefore the build system will automatically add the default HTML shell-file if none has been added yet.</li>
<li>Build system - when targeting macOS platform, the build tree will be configured to only target x86_64 arch by default as we are phasing out 32-bit mode. Use the URHO3D_UNIVERSAL build option, if you still want the universal binary build.</li>
</ul>
<p >From 1.7 to master:</p><ul>
<li>URHO3D_CXX11 define was removed. C++11 mode is unconditionally enabled.</li>
<li>URHO3D_ACCESSOR_VARIANT_VECTOR_STRUCTURE_ATTRIBUTE and URHO3D_MIXED_ACCESSOR_VARIANT_VECTOR_STRUCTURE_ATTRIBUTE macros were removed. Use attribute metadata instead. Element names shall be stored in StringVector (without trailing zero) instead of const char*[].</li>
<li>The Color::TRANSPARENT constant is renamed to <a class="el" href="class_urho3_d_1_1_color.html#a2a38c7a090d82b507f5600cb9f459a05" title="Transparent black color (black with no alpha).">Color::TRANSPARENT_BLACK</a> to avoid name clash with Windows's TRANSPARENT macro defined in "windows.h".</li>
<li>Constants are replaced with enums and flag sets in multiple places. Use corresponding types and typed constants instead of integers and integer constants. For example, "unsigned vertexMask = MASK_POSITION" becomes "VertexMaskFlags vertexMask = MASK_POSITION" and "input-&gt;GetKeyDown('A')" becomes "input-&gt;GetKeyDown(KEY_A)".</li>
<li><a class="el" href="class_urho3_d_1_1_string_hash.html#acb846dac0a51b1ecdcc8f4de4c30d089" title="Calculate hash value from a C string.">StringHash::Calculate()</a> method is now case-sensitive.</li>
<li>Build system - integrate with Gradle build system and migration to use Kotlin for Android platform.</li>
<li>Build system - introduce a new Emscripten-specific build option "EMSCRIPTEN_AUTO_SHELL" (default to TRUE), which cause the build system to automatically add an HTML shell-file if one is not explicitly given. Switch to LLVM WASM backend with the implication of removing the "EMSCRIPTEN_WASM" build option (WASM is now always enabled and we do not support asm.js anymore), also removing the SHARED and MODULE library types for Web platform (they do not build correctly with LLVM backend).</li>
<li>Build system - the 'WIN32' build option for 'cmake_generic.sh' is renamed to 'MINGW' to be consistent with 'cmake_generic.bat'.</li>
<li>Build system - CMake version 3.10.2 is now minimum version required for building Urho3D library on any host systems, except when targeting Android where version 3.17.3 is required.</li>
<li>Build system - RPI_ABI build option values are simplified to 'RPI0', 'RPI1', 'RPI2', 'RPI3', and 'RPI4'. Added 64-bit build support on RPI 4.</li>
<li>Build system: Reconfigure Apple build to not using the 'no_weak_imports' linker flags. This means the new build artifacts may not run correctly on old macOS/iOS/tvOS. It is up to the devs to handle the weak symbols during runtime in their own apps if they needs to be run on old systems. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Dec 10 2022 04:54:52 for Urho3D by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
